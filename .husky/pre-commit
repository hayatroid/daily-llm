#!/bin/sh

echo "ğŸ” Running quality checks..."

# Format and lint
echo "ğŸ“ Running format and lint..."
npm run format && npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ Format/lint failed. Please fix the issues and try again."
  exit 1
fi

# Check if any content files are changed
CONTENT_FILES=$(git diff --cached --name-only | grep "src/content/.*\.md" || true)
if [ -n "$CONTENT_FILES" ]; then
  echo "ğŸ“š Running textlint..."
  npm run textlint
  if [ $? -ne 0 ]; then
    echo "âŒ Textlint failed. Please fix the issues and try again."
    exit 1
  fi
fi

# Build test
echo "ğŸ—ï¸ Running build test..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed. Please fix the issues and try again."
  exit 1
fi

echo "âœ… All quality checks passed!"
exit 0