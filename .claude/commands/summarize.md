# /summarize 📊

## 目的

特定日の全会話を分析し、協働でタイトルを決めて日次サマリー（index.md）を作成する

## 使い方

`/summarize [日付]`

## 実行手順 📋

### Phase 1: 分析 (Analysis)

1. **対象日付の決定**:

   - 日付指定ありの場合: YYYY-MM-DD 形式を使用
   - 日付指定なしの場合: 今日の日付を使用
   - ディレクトリの存在確認

2. **ファイル読み込み**:

   - `src/content/daily/YYYY-MM-DD/` の `NNN-*.md` ファイルをスキャン
   - 各ファイルの frontmatter（title, tags, description）を抽出
   - 記事の核となるコンセプト・テーマを特定

3. **内容分析**:
   - 全記事の共通テーマ・哲学を特定
   - 技術的な要素と概念的な要素を分類
   - 記事間の関連性・発展性を分析
   - 実践的な洞察と将来展望を抽出

### Phase 2: 構造化 (Structure)

1. **メタデータ統合**:

   - **統合タグ**: 全記事のタグをマージし、重複除去（6-8個に厳選）
   - **共通テーマ**: 記事を貫く本質的なテーマを1-2個特定
   - **発展の流れ**: 記事の論理的な関連性を整理

2. **ナラティブ構築**:

   - 共通テーマを軸とした一貫したストーリーライン作成
   - 各記事の位置づけと相互関係を明確化
   - 全体を通した洞察・学びを整理

3. **重要ポイント抽出**:
   - 技術的な要素（実装・アーキテクチャ等）
   - 概念的な要素（哲学・アプローチ等）
   - 将来展望・応用可能性
   - 実践的な価値・次のステップ

### Phase 3: 協働作成 (Collaborative Creation)

1. **タイトル協議**:

   - 共通テーマを端的に表現するタイトル候補を2-3個提案
   - 以下の基準で協力してタイトル作成:
     - 共通テーマを適切に表現
     - 15-40文字の範囲内
     - 日々の学びを振り返りやすい表現
     - 単なる技術名羅列ではない魅力的な表現

2. **サマリー作成**:

   - Phase 2 で構築したナラティブに基づいて2-3段落で執筆
   - 日英混在の自然な文章（CLAUDE.md ルール準拠）
   - **日英混在文の書式確認**: 英単語の前後に半角スペースを必ず挿入
   - 重要なポイントを4個程度の箇条書きで整理
   - 全体の学びと将来への展望を含む締めくくり

3. **ファイル作成・フォーマット**:
   - `src/content/daily/YYYY-MM-DD/index.md` に書き込み
   - `npm run format && npm run lint` 実行 (CLAUDE.md 必須ルール)

## 判断基準 🎯

### 分析完了基準

- ✅ 全会話ファイルの frontmatter が正しく抽出された
- ✅ 各記事の核となるコンセプトが特定された
- ✅ 記事間の共通テーマが明確に特定された
- ✅ 技術要素・概念要素・将来展望が整理された

### タイトルの適切性

- ✅ 共通テーマを端的に表現している
- ✅ 15-40文字の範囲内
- ✅ 単なる技術名の羅列ではない
- ✅ 後から振り返りやすい表現になっている

### サマリーの完成度

- ✅ 共通テーマを軸とした一貫したナラティブ
- ✅ 各記事の位置づけと関連性が明確
- ✅ 重要なポイントが4個程度で適切に整理
- ✅ 日英混在文で英単語の前後に半角スペースが挿入されている
- ✅ 学びと将来展望を含む価値ある内容

## サマリーテンプレート 📄

```markdown
---
title: '[協議して決めたサマリータイトル]'
tags: ['統合された', '主要な', 'タグ', 'リスト']
description: '[その日の議論と主要トピックの1文概要]'
---

[共通テーマを軸とした一貫したナラティブ。2-3段落で、各記事の関連性と全体の学びを説明。]
注意: 英単語の前後には半角スペース → "TypeScript の型安全性", "React アプリケーション"

## 重要なポイント

- **[技術的要素]**: [具体的な実装・アーキテクチャ等の洞察]
- **[概念的要素]**: [哲学・アプローチ等の深い理解]
- **[将来展望]**: [応用可能性・発展性等の展望]
- **[実践的価値]**: [次のステップ・活用方法等]

[全体の学びと将来への展望を含む価値ある締めくくり文]
```

## 実行例 💫

```bash
# 入力
/summarize 2025-06-29

# プロセス
1. 分析: 2ファイル読み込み → Branded Types + テスト駆動物理 → 共通テーマ「コンパイルタイムガードレール」特定
2. 構造化: タグ統合(8個) → ナラティブ構築(型安全性→教育技術) → 重要ポイント抽出(4個)
3. タイトル協議: 候補提案 → 協議 → 決定「型安全性から教育技術へ：コンパイルタイムガードレールの探求」(38文字)

# 出力
src/content/daily/2025-06-29/index.md
フォーマット: npm run format && npm run lint (正常完了)
```

## エラーハンドリング 🛡️

- 日付ディレクトリが存在しない場合: 利用可能な日付を表示してエラー終了
- 会話ファイルが見つからない場合: 最小限のテンプレートでサマリー作成を提案
- index.md が既に存在する場合: 上書き確認をユーザーに求める
- frontmatter が不適切な場合: 該当ファイルを報告して修正を促す

## 成功の基準 🎯

- ✅ 上記の判断基準をすべて満たしている
- ✅ 全ファイルの分析が適切に完了した
- ✅ 共通テーマの特定とナラティブ構築が成功した
- ✅ タイトル協議プロセスが適切に実行された
- ✅ サマリーが標準テンプレートに従っている
- ✅ 日英混在文で英単語の前後に半角スペースが正しく挿入されている
- ✅ `npm run format && npm run lint` が正常完了
- ✅ CLAUDE.md フォーマットルールに準拠
- ✅ 後から読み返して価値のあるサマリーになっている
