---
title: 'マルコフを理解したい 1'
description: 'マルコフ解析の具体的問題から出発し、無記憶性の本質と様々な確率分布の統一的理解へ至る思考の軌跡'
---

ユーザは、マルコフ解析の問題を前に途方に暮れていた。

考えてみると、私たちの身の回りには「今の状態が次の状態に影響する」現象があふれている。今日晴れなら明日も晴れやすい。満員電車は次の駅でも満員のまま。そんな当たり前の現象に、どんな数学的構造が隠れているのだろうか？

## 違和感の芽生え

$N$ 個のボールが 2 つの壺に入っていて、ランダムに取り出してコインを投げる。表なら $A$、裏なら $B$ に入れる...

一見単純そうな操作だ。でもちょっと待てよ。「マルコフ連鎖であることを示せ」と言われても、何を示せばいいのだろう？

ここで立ち止まって考えてみよう。

そもそも「次に $A$ に何個入るか」を予測するのに、何の情報が必要だろうか？

- 100 回前の状態？
- 50 回前の状態？
- それとも...

じっくり考えてみると、ある単純な事実に気づく。

「今 $A$ に何個入っているか」さえ分かれば十分ではないか？過去の履歴は関係ない。これが「無記憶性」の最初の手がかりだった。

## 数学的定義との格闘

しかし講義資料を見ると、見慣れない記号が並んでいる。

「$S$ 値離散時間確率過程」
「$\forall n \in \mathbb{N}_0$ & $\forall i_0,i_1,...,i,j \in S$ s.t. ...」

うーん、何だこれは？

ユーザは基本から理解することにした。「s.t.」は「〜を満たす」、確率過程は「時間とともに変化する確率的現象」。

そして核心の等式に到達した：

$$
P\left(X_{n+1} = j | X_0 = i_0, X_1 = i_1, ..., X_n = i\right) = P\left(X_{n+1} = j | X_n = i\right)
$$

この式をじっくり眺めてみよう。

左辺：過去の全履歴を知った上での条件付き確率
右辺：現在の状態だけを知った上での条件付き確率

これらが等しい...？

つまり「どんな道筋を辿って現在に至ったかは関係なく、次の状態は現在だけで決まる」ということか。先ほどの直感が、数式で正確に表現されていた。

## 推移確率の罠

無記憶性は理解できた。では、具体的に推移確率を計算してみよう。

最初、ユーザは「どの壺から取り出すかは均等だから...」と考えた。

でも、何か違和感がある。本当に均等だろうか？

$N$ 個のボールから 1 個をランダムに選ぶのだから：

- $A$ から取り出す確率：$i/N$
- $B$ から取り出す確率：$(N-i)/N$

あ、そうか！$A$ に入っているボールの数に比例するんだ。

ここから推移確率が導かれる：

- $P(i \to i+1) = \frac{N-i}{N} \times p$（$B$ から取って $A$ へ）
- $P(i \to i-1) = \frac{i}{N} \times q$（$A$ から取って $B$ へ）
- $P(i \to i) = \frac{i}{N} \times p + \frac{N-i}{N} \times q$（元の壺に戻る）

ちょっと待って、これらを全部足すと...確かに 1 になる！単純に見えて、実は精巧な構造があった。

## 長時間後の謎

さて、推移確率は分かった。でも新たな疑問が浮かぶ。

この操作を 1000 回、10000 回と繰り返したら、最終的にどんな分布になるのだろう？

定常分布を求めるには $\pi = \pi P$ という行列方程式を解けばいい。でも $N$ 個の連立方程式を解くのは大変そうだ...

もっとエレガントな方法はないだろうか？

ここで面白い発想が浮かんだ。

お風呂の水位を考えてみよう。蛇口から入る水と、排水口から出る水が同じなら、水位は一定に保たれる。

確率の流れも同じではないか？任意の状態集合 $C$ について、「$C$ から出ていく流れ」と「$C$ に入ってくる流れ」が釣り合うはずだ。

おっと、この系には特別な性質がある。隣接状態間でしか推移しない！

ということは、境界での流量保存を考えるだけでいい：

$$
\pi_i \times P\left(i \to i+1\right) = \pi_{i+1} \times P\left(i+1 \to i\right)
$$

この単純な釣り合い式から、何が導かれるだろうか？

実は、ここから驚くべき結果が現れる。

## 衝撃の発見

詳細釣り合い条件を使って、$\pi_0$ から順に計算していくと...

$$
\pi_i = \binom{N}{i} p^i q^{N-i}
$$

ちょっと待って、これは...

二項分布 $B(N, p)$ そのものだ！

なぜこうなるのか？じっくり考えてみよう。

...

あ、そうか。ボールには個性がない。どのボールも同じ確率で $A$ か $B$ に入る。

十分時間が経てば、過去の経緯は完全に忘れ去られ、まるで最初に $N$ 枚のコインを投げて配置を決めたかのような分布になる。

これがマルコフ連鎖の「忘却性」の真の姿だった。

## さらなる疑問

ここまで来て、ユーザの頭に新たな疑問が浮かんだ。

「なぜ収束は指数的に速いのか？」
「他の分布に収束する例はないのか？」

この疑問を追求していくと、驚くべき原理が見えてきた：

1. **マルコフ性（無記憶性）** → 指数的収束の速さ
2. **系の構造** → 収束先の分布の形

この原理で他の分布も説明できるだろうか？

考えてみると...

- ポアソン分布：$M/M/\infty$ 待ち行列（二項分布の希少事象極限）
- 幾何分布：成功まで繰り返す試行（始点が 0 という制約）
- 一様分布：カードシャッフル（制約なしのエントロピー最大化）

何か共通点が見えてこないだろうか？

...

そうか！すべて「制約下でのエントロピー最大化」として統一的に理解できる。まるで統計力学のように、マクロな制約からミクロな分布が決まっているんだ。

## 発見の連鎖

最初は単なる問題解法を求めていたユーザだったが、対話を通じて次々と深い洞察に到達した：

- 無記憶性の直感的理解から数学的定式化へ
- 平衡方程式による巧妙な解法の発見
- 二項分布の必然性の理解
- 指数的収束と分布の形の独立性
- 様々な確率分布の統一的視点

振り返ってみると、マルコフ連鎖は単なる数学的道具ではなかった。

現実世界の「記憶のないプロセス」を記述する普遍的な言語だったのだ。コンデンサの放電も、分子の拡散も、遺伝的浮動も、すべて同じ原理に支配されている。

この発見の旅は、一つの具体的な問題から始まった。壺とボールという素朴な設定から、最終的には自然界の根本原理へと到達した。

数学の美しさは、このような予期せぬつながりを明らかにしてくれることにある。そして何より、自分で発見する喜びこそが、真の理解への道なのだ。
