---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Pwd from '../../components/Pwd.astro';
import Cat from '../../components/Cat.astro';
import Prompt from '../../components/Prompt.astro';
import { getCollection } from 'astro:content';
import {
  isConversationEntry,
  extractDate,
  extractFilename,
} from '../../lib/entry-utils';

export async function getStaticPaths() {
  const allEntries = await getCollection('daily');
  const conversationEntries = allEntries.filter(isConversationEntry);

  return conversationEntries.map((entry) => ({
    params: {
      date: extractDate(entry),
      conversation: extractFilename(entry),
    },
  }));
}

const { date, conversation } = Astro.params;

const pageTitle = `${conversation} - ${date}`;
---

<BaseLayout title={pageTitle}>
  <Pwd path={`/${date}/${conversation}`} />
  <Cat path={`/${date}/${conversation}`} />
</BaseLayout>
