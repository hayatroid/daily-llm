---
import Layout from '../../components/lv3-layout/Layout.astro';
import Pwd from '../../components/lv2-commands/Pwd.astro';
import Cat from '../../components/lv2-commands/Cat.astro';
import { getCollection, type CollectionEntry } from 'astro:content';
import { Entry } from '../../lib/util';

export async function getStaticPaths() {
  const allEntries = await getCollection('daily');
  const conversations = allEntries.filter(Entry.isConversation);

  return conversations.map((entry: CollectionEntry<'daily'>) => {
    const { date, filename } = Entry.parse(entry);
    return {
      params: {
        date,
        conversation: filename,
      },
    };
  });
}

const { date, conversation } = Astro.params;

const pageTitle = `${conversation} - ${date}`;
---

<Layout title={pageTitle}>
  <Pwd path={`/${date}/${conversation}`} />
  <Cat path={`/${date}/${conversation}`} />
</Layout>
