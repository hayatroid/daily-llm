---
import BaseLayout from '../layouts/BaseLayout.astro';
import DailySummaryCard from '../components/DailySummaryCard.astro';

// Get all content files
const allContent = await Astro.glob('../../content/**/*.md');

// Get all summary files
const summaries = allContent.filter(file => file.file.endsWith('summary.md'));

// Sort by date (newest first)
const sortedSummaries = summaries.sort((a, b) => {
  return new Date(b.frontmatter.date).getTime() - new Date(a.frontmatter.date).getTime();
});
---

<BaseLayout title="Daily LLM Conversations">
  <div class="main-content">
    <div class="intro">
      <p class="comment"># Daily AI conversation summaries</p>
      <p class="comment"># Click on any date to explore full conversations</p>
    </div>

    <div class="summaries-grid">
      {sortedSummaries.map((summary) => (
        <DailySummaryCard summary={summary} allContent={allContent} />
      ))}
    </div>

    {sortedSummaries.length === 0 && (
      <div class="empty">
        <p class="comment"># No conversations yet</p>
        <p>Start by adding files to <code>content/YYYY-MM-DD/</code></p>
      </div>
    )}
  </div>
</BaseLayout>

<style>
  .intro {
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--term-gray);
  }
  
  .summaries-grid {
    display: grid;
    gap: 1.5rem;
    grid-template-columns: 1fr;
  }
  
  @media (min-width: 768px) {
    .summaries-grid {
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    }
  }
  
  .empty {
    text-align: center;
    padding: 40px;
    border: 1px dashed var(--term-gray);
    border-radius: 4px;
    margin-top: 2rem;
  }
</style>