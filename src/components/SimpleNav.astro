---
import BreadcrumbNav from './BreadcrumbNav.astro';
import { generateNavigationContext, generateBreadcrumbs } from '../utils/navigationData.js';
import { ICONS } from '../utils/icons.js';

export interface Props {
  currentDate?: string;
  currentPage?: 'home' | 'date' | 'conversation';
  conversationSlug?: string;
  conversationTitle?: string;
  allContent: any[];
}

const { 
  currentDate, 
  currentPage = 'home', 
  conversationSlug, 
  conversationTitle,
  allContent = []
} = Astro.props;

// Generate navigation context for prev/next
const navigationContext = currentDate 
  ? generateNavigationContext(allContent, currentDate)
  : { previousDate: null, nextDate: null };

// Generate breadcrumbs
const breadcrumbs = generateBreadcrumbs(currentDate, conversationSlug, conversationTitle);

// Show date navigation only on date/conversation pages
const showDateNav = currentPage !== 'home' && currentDate;
---

<nav class="simple-nav" role="navigation" aria-label="Site navigation">
  <div class="nav-content">
    <BreadcrumbNav items={breadcrumbs} />
    
    {showDateNav && (
      <div class="date-nav">
        {navigationContext.previousDate && (
          <a href={`/${navigationContext.previousDate}/`} class="nav-link prev">
            {ICONS.ARROW_LEFT} {navigationContext.previousDate}
          </a>
        )}
        {navigationContext.nextDate && (
          <a href={`/${navigationContext.nextDate}/`} class="nav-link next">
            {navigationContext.nextDate} {ICONS.ARROW_RIGHT}
          </a>
        )}
      </div>
    )}
  </div>
</nav>

<style>
  .simple-nav {
    margin-bottom: var(--space-md);
    padding: var(--space-sm) var(--space-md);
    background: rgba(0, 255, 0, 0.03);
    border: 1px solid var(--term-dim);
    border-radius: 3px;
  }

  .nav-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-md);
    max-width: 1400px;
    margin: 0 auto;
  }

  .date-nav {
    display: flex;
    gap: var(--space-sm);
    align-items: center;
  }

  .nav-link {
    color: var(--term-amber);
    text-decoration: none;
    font-size: var(--text-small);
    padding: var(--space-xs) var(--space-sm);
    border: 1px solid var(--term-amber);
    border-radius: 3px;
    transition: all 0.2s ease;
  }

  .nav-link:hover {
    background: var(--term-amber);
    color: var(--term-bg);
  }

  .nav-link:focus {
    outline: 2px solid var(--term-green);
    outline-offset: 1px;
  }

  /* Responsive design */
  @media (max-width: 767px) {
    .simple-nav {
      margin-bottom: var(--space-sm);
      padding: var(--space-sm);
    }

    .nav-content {
      flex-direction: column;
      gap: var(--space-sm);
    }

    .date-nav {
      gap: var(--space-xs);
    }

    .nav-link {
      font-size: var(--text-small-mobile);
      padding: var(--space-xs) var(--space-sm);
    }
  }
</style>