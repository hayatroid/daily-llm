---
import Prompt from './Prompt.astro';

export interface Props {
  path: string;
}

const { path } = Astro.props;

// Create breadcrumbs from path
function createBreadcrumbs(path: string) {
  const breadcrumbs = [];
  
  // Always start with Home
  breadcrumbs.push({ label: 'Home', href: '/', current: path === '/' });
  
  if (path === '/') {
    return breadcrumbs;
  }
  
  const parts = path.split('/').filter(Boolean);
  let currentPath = '';
  
  for (let i = 0; i < parts.length; i++) {
    currentPath += '/' + parts[i];
    const isLast = i === parts.length - 1;
    
    // Handle special paths
    if (parts[i] === 'tags') {
      breadcrumbs.push({ 
        label: 'tags', 
        href: '/tags/', 
        current: isLast 
      });
    } else if (parts[0] === 'tags' && i === 1) {
      // Tag name after /tags/
      breadcrumbs.push({ 
        label: parts[i], 
        href: `/tags/${encodeURIComponent(parts[i])}/`, 
        current: isLast 
      });
    } else {
      // Date or other paths
      breadcrumbs.push({ 
        label: parts[i], 
        href: currentPath + '/', 
        current: isLast 
      });
    }
  }
  
  return breadcrumbs;
}

const breadcrumbs = createBreadcrumbs(path);
---

<nav class="cli-nav">
  <div class="pwd command-block">
    <Prompt command="pwd" />
  </div>
  <div class="path">
    <div class="breadcrumb">
      {breadcrumbs.map((item, index) => (
        <>
          <a href={item.href || '#'} class:list={['path-link', { current: item.current }]}>
            {item.label}
          </a>
          {index < breadcrumbs.length - 1 && (
            <span class="path-separator">/</span>
          )}
        </>
      ))}
    </div>
  </div>
</nav>

<style>
  .cli-nav {
    font-family: var(--font-mono);
    font-size: var(--text-normal);
  }

  .pwd {
    display: flex;
    gap: var(--gap-default);
    margin-bottom: var(--space-xs);
  }

  .path {
    margin-bottom: var(--space-sm);
  }

  .breadcrumb {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--gap-none);
    font-family: var(--font-mono);
  }

  .path-link {
    transition: color var(--duration-fast) ease;
  }

  .path-separator {
    margin: 0 calc(var(--char-offset) * var(--char-multiplier));
  }


</style>